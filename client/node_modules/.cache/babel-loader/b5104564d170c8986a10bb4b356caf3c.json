{"ast":null,"code":"import _objectSpread from\"C:/Users/Pechenka/pixel-app-ts/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Pechenka/pixel-app-ts/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useContext,useEffect,useState,useRef}from\"react\";import classes from\"./PreviewAnimation.module.css\";import SimplePixel from\"../../SimplePixel/SimplePixel\";import{ArtsContext}from\"../../../context/arts-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PreviewAnimation=function PreviewAnimation(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),play=_useState2[0],setPlay=_useState2[1];var _ref=useContext(ArtsContext),artsState=_ref.artsState;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),artToShow=_useState4[0],setArtToShow=_useState4[1];var timer=useRef(null);var updateArtToShow=useCallback(function(){setArtToShow(function(prevArt){var index=prevArt.id+1;if(index===artsState.arts.length){index=0;}var art=artsState.arts.find(function(art){return art.id===index;});return art;});},[artsState.arts]);useEffect(function(){if(!play){var art=artsState.arts.find(function(art){return art.id===artsState.chosen;});setArtToShow(art);}},[artsState,play]);useEffect(function(){if(play){if(timer.current===null){if(!isNaN(+props.duration)){setArtToShow(artsState.arts[0]);timer.current=setInterval(updateArtToShow,+props.duration*1000);}}}else if(timer.current!==null){clearInterval(timer.current);timer.current=null;}},[play,props.duration,updateArtToShow,artToShow,artsState.arts]);var onTogglePlayHandler=function onTogglePlayHandler(){setPlay(!play);};var ps=6;return/*#__PURE__*/_jsxs(\"div\",{className:classes.PreviewAnimation,children:[/*#__PURE__*/_jsx(\"button\",{className:classes.PlayButton,onClick:onTogglePlayHandler,children:!play?/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"#313131\",children:[/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"}),/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})]}):/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"transparent\",stroke:\"rgb(224, 34, 34)\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.PreviewAnimationSpace,children:/*#__PURE__*/_jsx(\"div\",{children:artToShow&&artToShow.rows.map(function(row){return/*#__PURE__*/_jsx(\"div\",{className:classes.Row,children:row.map(function(pix){return/*#__PURE__*/_jsx(SimplePixel,{ps:ps,pix:_objectSpread(_objectSpread({},pix),{},{color:pix.color===artsState.settings.defColor?\"transparent\":pix.color})},pix.ypos.toString()+pix.xpos);})},artToShow.rows.indexOf(row));})})})]});};export default PreviewAnimation;","map":{"version":3,"sources":["C:/Users/Pechenka/pixel-app-ts/client/src/components/SettingsBar/PreviewAnimation/PreviewAnimation.tsx"],"names":["useCallback","useContext","useEffect","useState","useRef","classes","SimplePixel","ArtsContext","PreviewAnimation","props","play","setPlay","artsState","artToShow","setArtToShow","timer","updateArtToShow","prevArt","index","id","arts","length","art","find","chosen","current","isNaN","duration","setInterval","clearInterval","onTogglePlayHandler","ps","PlayButton","PreviewAnimationSpace","rows","map","row","Row","pix","color","settings","defColor","ypos","toString","xpos","indexOf"],"mappings":"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","sourcesContent":["import { useCallback, useContext, useEffect, useState, useRef } from \"react\";\r\n\r\nimport classes from \"./PreviewAnimation.module.css\";\r\nimport SimplePixel from \"../../SimplePixel/SimplePixel\";\r\n\r\nimport { Art, ArtsContext } from \"../../../context/arts-context\";\r\n\r\ninterface PreviewAnimationProps {\r\n  duration: number | string;\r\n}\r\n\r\nconst PreviewAnimation = (props: PreviewAnimationProps) => {\r\n  const [play, setPlay] = useState(false);\r\n  const { artsState } = useContext(ArtsContext)!;\r\n  const [artToShow, setArtToShow] = useState<null | Art>(null);\r\n  let timer = useRef<null | NodeJS.Timer>(null);\r\n\r\n  const updateArtToShow = useCallback(() => {\r\n    setArtToShow((prevArt) => {\r\n      let index = prevArt!.id + 1;\r\n      if (index === artsState.arts.length) {\r\n        index = 0;\r\n      }\r\n      const art = artsState.arts.find((art) => art.id === index)!;\r\n      return art;\r\n    });\r\n  }, [artsState.arts]);\r\n\r\n  useEffect(() => {\r\n    if (!play) {\r\n      const art = artsState.arts.find((art) => art.id === artsState.chosen)!;\r\n      setArtToShow(art);\r\n    }\r\n  }, [artsState, play]);\r\n\r\n  useEffect(() => {\r\n    if (play) {\r\n      if (timer.current === null) {\r\n        if (!isNaN(+props.duration)) {\r\n          setArtToShow(artsState.arts[0]);\r\n          timer.current = setInterval(updateArtToShow, +props.duration * 1000);\r\n        }\r\n      }\r\n    } else if (timer.current !== null) {\r\n      clearInterval(timer.current);\r\n      timer.current = null;\r\n    }\r\n  }, [play, props.duration, updateArtToShow, artToShow, artsState.arts]);\r\n\r\n  const onTogglePlayHandler = () => {\r\n    setPlay(!play);\r\n  };\r\n\r\n  const ps = 6;\r\n\r\n  return (\r\n    <div className={classes.PreviewAnimation}>\r\n      <button className={classes.PlayButton} onClick={onTogglePlayHandler}>\r\n        {!play ? (\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-6 w-6\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"#313131\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth=\"2\"\r\n              d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"\r\n            />\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth=\"2\"\r\n              d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n            />\r\n          </svg>\r\n        ) : (\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-5 w-5\"\r\n            viewBox=\"0 0 20 20\"\r\n            fill=\"transparent\"\r\n            stroke=\"rgb(224, 34, 34)\"\r\n          >\r\n            <path\r\n              fillRule=\"evenodd\"\r\n              d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z\"\r\n              clipRule=\"evenodd\"\r\n            />\r\n          </svg>\r\n        )}\r\n      </button>\r\n      <div className={classes.PreviewAnimationSpace}>\r\n        <div>\r\n          {artToShow &&\r\n            artToShow.rows.map((row) => (\r\n              <div className={classes.Row} key={artToShow.rows.indexOf(row)}>\r\n                {row.map((pix) => (\r\n                  <SimplePixel\r\n                    key={pix.ypos.toString() + pix.xpos}\r\n                    ps={ps}\r\n                    pix={{\r\n                      ...pix,\r\n                      color:\r\n                        pix.color === artsState.settings.defColor\r\n                          ? \"transparent\"\r\n                          : pix.color,\r\n                    }}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PreviewAnimation;\r\n"]},"metadata":{},"sourceType":"module"}