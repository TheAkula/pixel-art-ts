{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pechenka\\\\pixel-app-ts\\\\client\\\\src\\\\context\\\\arts-context.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useReducer } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  arts: [],\n  chosen: null,\n  history: {\n    prevHistory: [],\n    nextHistory: []\n  }\n};\nexport const ArtsContext = /*#__PURE__*/React.createContext(null);\n\nconst reducer = (state, action) => {\n  const curSnapshot = JSON.parse(JSON.stringify(state.arts));\n  const newHistory = {\n    prevHistory: state.history.prevHistory.concat(curSnapshot),\n    nextHistory: []\n  };\n\n  switch (action.type) {\n    case \"ADD_ART\":\n      return { ...state,\n        arts: [...state.arts, action.data],\n        chosen: action.data.id,\n        history: newHistory\n      };\n\n    case \"ADD_ROW\":\n      const newArts = JSON.parse(JSON.stringify(state.arts));\n      newArts.forEach(art => {\n        art.rows.push(action.data);\n      });\n      return { ...state,\n        arts: newArts,\n        history: newHistory\n      };\n\n    case \"DEL_ROW\":\n      const arts = JSON.parse(JSON.stringify(state.arts));\n      if (arts[0].rows.length === 1) return { ...state,\n        arts: state.arts\n      };\n      arts.forEach(art => {\n        art.rows.pop();\n      });\n      return { ...state,\n        arts: arts,\n        history: newHistory\n      };\n\n    case \"ADD_COL\":\n      const arts1 = JSON.parse(JSON.stringify(state.arts));\n      arts1.forEach(art => {\n        art.rows.forEach((row, id) => {\n          row.push({\n            xpos: action.data.x,\n            ypos: id,\n            color: action.data.color\n          });\n        });\n      });\n      return { ...state,\n        arts: arts1,\n        history: newHistory\n      };\n\n    case \"DEL_COL\":\n      const arts2 = JSON.parse(JSON.stringify(state.arts));\n      if (arts2[0].rows[0].length === 1) return { ...state,\n        arts: state.arts\n      };\n      arts2.forEach(art => {\n        art.rows.forEach(row => {\n          row.pop();\n        });\n      });\n      return { ...state,\n        arts: arts2,\n        history: newHistory\n      };\n\n    case \"SET_CHOSEN\":\n      return { ...state,\n        chosen: action.data,\n        history: newHistory\n      };\n\n    case \"SET_PIX\":\n      let arts3 = JSON.parse(JSON.stringify(state.arts));\n      const a = arts3.find(art => art.id === action.artId);\n      arts3[arts3.indexOf(a)].rows[action.y][action.x].color = action.data;\n      return { ...state,\n        arts: arts3,\n        history: newHistory\n      };\n\n    case \"DELETE_ART\":\n      if (state.arts.length === 1) return { ...state\n      };\n      const deletedArt = state.arts.find(art => art.id === action.data);\n      const arts4 = JSON.parse(JSON.stringify(state.arts));\n      const startArts = arts4.slice(0, deletedArt.id);\n      const endArts = arts4.slice(deletedArt.id + 1);\n      endArts.forEach(art => {\n        art.id = art.id - 1;\n      });\n      return { ...state,\n        chosen: state.arts.length - 2,\n        arts: startArts.concat(endArts),\n        history: newHistory\n      };\n\n    case \"COPY_ART\":\n      const copiedArt = JSON.parse(JSON.stringify(state.arts.find(art => art.id === action.data)));\n      const newArts1 = JSON.parse(JSON.stringify(state.arts));\n      copiedArt.id = copiedArt.id + 1;\n      const updArts1 = newArts1.slice(0, copiedArt.id).concat(copiedArt);\n      const updArts2 = newArts1.slice(copiedArt.id).map(art => {\n        art.id = art.id + 1;\n        return art;\n      });\n      return { ...state,\n        chosen: state.chosen + 1,\n        arts: updArts1.concat(updArts2),\n        history: newHistory\n      };\n\n    case \"UPD_ART\":\n      const updatedArts = JSON.parse(JSON.stringify(state.arts));\n      let art = updatedArts.find(art => art.id === action.artId);\n      updatedArts[updatedArts.indexOf(art)] = action.data;\n      return { ...state,\n        arts: updatedArts,\n        chosen: state.chosen,\n        history: newHistory\n      };\n\n    case \"BACK_HIS\":\n      if (!state.history.prevHistory.length) {\n        return { ...state\n        };\n      }\n\n      const lastSnapshot = state.history.prevHistory.at(-1);\n      return { ...state,\n        history: {\n          prevHistory: state.history.prevHistory.slice(0, -1),\n          nextHistory: state.history.nextHistory.concat(lastSnapshot)\n        },\n        arts: lastSnapshot\n      };\n\n    case \"NEXT_HIS\":\n      if (!state.history.nextHistory.length) {\n        return { ...state\n        };\n      }\n\n      const lastSnapshot1 = state.history.prevHistory.at(-1);\n      return { ...state,\n        history: {\n          prevHistory: state.history.prevHistory.concat(lastSnapshot1),\n          nextHistory: state.history.nextHistory.slice(0, -1)\n        },\n        arts: lastSnapshot1\n      };\n\n    default:\n      throw new Error(\"Uncaught type: \" + action.type);\n  }\n};\n\nconst ArtsContextProvider = props => {\n  _s();\n\n  const [state, dispatch] = useReducer(reducer, initialState);\n  return /*#__PURE__*/_jsxDEV(ArtsContext.Provider, {\n    value: {\n      arts: state,\n      artsDispatch: dispatch\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 215,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ArtsContextProvider, \"6JWkGZ32UPfojeNx+xqn8ZU8A0Q=\");\n\n_c = ArtsContextProvider;\nexport default ArtsContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ArtsContextProvider\");","map":{"version":3,"sources":["C:/Users/Pechenka/pixel-app-ts/client/src/context/arts-context.tsx"],"names":["React","useReducer","initialState","arts","chosen","history","prevHistory","nextHistory","ArtsContext","createContext","reducer","state","action","curSnapshot","JSON","parse","stringify","newHistory","concat","type","data","id","newArts","forEach","art","rows","push","length","pop","arts1","row","xpos","x","ypos","color","arts2","arts3","a","find","artId","indexOf","y","deletedArt","arts4","startArts","slice","endArts","copiedArt","newArts1","updArts1","updArts2","map","updatedArts","lastSnapshot","at","lastSnapshot1","Error","ArtsContextProvider","props","dispatch","artsDispatch","children"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;;AAyCA,MAAMC,YAA8B,GAAG;AACrCC,EAAAA,IAAI,EAAE,EAD+B;AAErCC,EAAAA,MAAM,EAAE,IAF6B;AAGrCC,EAAAA,OAAO,EAAE;AACPC,IAAAA,WAAW,EAAE,EADN;AAEPC,IAAAA,WAAW,EAAE;AAFN;AAH4B,CAAvC;AASA,OAAO,MAAMC,WAAW,gBAAGR,KAAK,CAACS,aAAN,CAA8C,IAA9C,CAApB;;AAMP,MAAMC,OAAoB,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC9C,QAAMC,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAApB;AACA,QAAMc,UAAU,GAAG;AACjBX,IAAAA,WAAW,EAAEK,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BY,MAA3B,CAAkCL,WAAlC,CADI;AAEjBN,IAAAA,WAAW,EAAE;AAFI,GAAnB;;AAIA,UAAQK,MAAM,CAACO,IAAf;AACE,SAAK,SAAL;AACE,aAAO,EACL,GAAGR,KADE;AAELR,QAAAA,IAAI,EAAE,CAAC,GAAGQ,KAAK,CAACR,IAAV,EAAiBS,MAAM,CAACQ,IAAxB,CAFD;AAGLhB,QAAAA,MAAM,EAAEQ,MAAM,CAACQ,IAAP,CAAYC,EAHf;AAILhB,QAAAA,OAAO,EAAEY;AAJJ,OAAP;;AAMF,SAAK,SAAL;AACE,YAAMK,OAAO,GAAGR,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAhB;AACAmB,MAAAA,OAAO,CAACC,OAAR,CAAiBC,GAAD,IAAS;AACvBA,QAAAA,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcd,MAAM,CAACQ,IAArB;AACD,OAFD;AAGA,aAAO,EACL,GAAGT,KADE;AAELR,QAAAA,IAAI,EAAEmB,OAFD;AAGLjB,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,SAAL;AACE,YAAMd,IAAI,GAAGW,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAb;AACA,UAAIA,IAAI,CAAC,CAAD,CAAJ,CAAQsB,IAAR,CAAaE,MAAb,KAAwB,CAA5B,EAA+B,OAAO,EAAE,GAAGhB,KAAL;AAAYR,QAAAA,IAAI,EAAEQ,KAAK,CAACR;AAAxB,OAAP;AAC/BA,MAAAA,IAAI,CAACoB,OAAL,CAAcC,GAAD,IAAS;AACpBA,QAAAA,GAAG,CAACC,IAAJ,CAASG,GAAT;AACD,OAFD;AAGA,aAAO,EACL,GAAGjB,KADE;AAELR,QAAAA,IAAI,EAAEA,IAFD;AAGLE,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,SAAL;AACE,YAAMY,KAAK,GAAGf,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAd;AACA0B,MAAAA,KAAK,CAACN,OAAN,CAAeC,GAAD,IAAS;AACrBA,QAAAA,GAAG,CAACC,IAAJ,CAASF,OAAT,CAAiB,CAACO,GAAD,EAAMT,EAAN,KAAa;AAC5BS,UAAAA,GAAG,CAACJ,IAAJ,CAAS;AAAEK,YAAAA,IAAI,EAAEnB,MAAM,CAACQ,IAAP,CAAYY,CAApB;AAAuBC,YAAAA,IAAI,EAAEZ,EAA7B;AAAiCa,YAAAA,KAAK,EAAEtB,MAAM,CAACQ,IAAP,CAAYc;AAApD,WAAT;AACD,SAFD;AAGD,OAJD;AAKA,aAAO,EACL,GAAGvB,KADE;AAELR,QAAAA,IAAI,EAAE0B,KAFD;AAGLxB,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,SAAL;AACE,YAAMkB,KAAK,GAAGrB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAd;AACA,UAAIgC,KAAK,CAAC,CAAD,CAAL,CAASV,IAAT,CAAc,CAAd,EAAiBE,MAAjB,KAA4B,CAAhC,EAAmC,OAAO,EAAE,GAAGhB,KAAL;AAAYR,QAAAA,IAAI,EAAEQ,KAAK,CAACR;AAAxB,OAAP;AACnCgC,MAAAA,KAAK,CAACZ,OAAN,CAAeC,GAAD,IAAS;AACrBA,QAAAA,GAAG,CAACC,IAAJ,CAASF,OAAT,CAAkBO,GAAD,IAAS;AACxBA,UAAAA,GAAG,CAACF,GAAJ;AACD,SAFD;AAGD,OAJD;AAKA,aAAO,EACL,GAAGjB,KADE;AAELR,QAAAA,IAAI,EAAEgC,KAFD;AAGL9B,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,YAAL;AACE,aAAO,EACL,GAAGN,KADE;AAELP,QAAAA,MAAM,EAAEQ,MAAM,CAACQ,IAFV;AAGLf,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,SAAL;AACE,UAAImB,KAAK,GAAGtB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAZ;AACA,YAAMkC,CAAC,GAAGD,KAAK,CAACE,IAAN,CAAYd,GAAD,IAASA,GAAG,CAACH,EAAJ,KAAWT,MAAM,CAAC2B,KAAtC,CAAV;AACAH,MAAAA,KAAK,CAACA,KAAK,CAACI,OAAN,CAAcH,CAAd,CAAD,CAAL,CAAwBZ,IAAxB,CAA6Bb,MAAM,CAAC6B,CAApC,EAAwC7B,MAAM,CAACoB,CAA/C,EAAmDE,KAAnD,GAA2DtB,MAAM,CAACQ,IAAlE;AACA,aAAO,EACL,GAAGT,KADE;AAELR,QAAAA,IAAI,EAAEiC,KAFD;AAGL/B,QAAAA,OAAO,EAAEY;AAHJ,OAAP;;AAKF,SAAK,YAAL;AACE,UAAIN,KAAK,CAACR,IAAN,CAAWwB,MAAX,KAAsB,CAA1B,EACE,OAAO,EACL,GAAGhB;AADE,OAAP;AAGF,YAAM+B,UAAU,GAAG/B,KAAK,CAACR,IAAN,CAAWmC,IAAX,CAAiBd,GAAD,IAASA,GAAG,CAACH,EAAJ,KAAWT,MAAM,CAACQ,IAA3C,CAAnB;AACA,YAAMuB,KAAK,GAAG7B,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAd;AACA,YAAMyC,SAAS,GAAGD,KAAK,CAACE,KAAN,CAAY,CAAZ,EAAeH,UAAU,CAACrB,EAA1B,CAAlB;AACA,YAAMyB,OAAO,GAAGH,KAAK,CAACE,KAAN,CAAYH,UAAU,CAACrB,EAAX,GAAgB,CAA5B,CAAhB;AACAyB,MAAAA,OAAO,CAACvB,OAAR,CAAiBC,GAAD,IAAS;AACvBA,QAAAA,GAAG,CAACH,EAAJ,GAASG,GAAG,CAACH,EAAJ,GAAS,CAAlB;AACD,OAFD;AAGA,aAAO,EACL,GAAGV,KADE;AAELP,QAAAA,MAAM,EAAEO,KAAK,CAACR,IAAN,CAAWwB,MAAX,GAAoB,CAFvB;AAGLxB,QAAAA,IAAI,EAAEyC,SAAS,CAAC1B,MAAV,CAAiB4B,OAAjB,CAHD;AAILzC,QAAAA,OAAO,EAAEY;AAJJ,OAAP;;AAMF,SAAK,UAAL;AACE,YAAM8B,SAAS,GAAGjC,IAAI,CAACC,KAAL,CAChBD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAAN,CAAWmC,IAAX,CAAiBd,GAAD,IAASA,GAAG,CAACH,EAAJ,KAAWT,MAAM,CAACQ,IAA3C,CAAf,CADgB,CAAlB;AAGA,YAAM4B,QAAQ,GAAGlC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAAjB;AACA4C,MAAAA,SAAS,CAAC1B,EAAV,GAAe0B,SAAS,CAAC1B,EAAV,GAAe,CAA9B;AACA,YAAM4B,QAAQ,GAAGD,QAAQ,CAACH,KAAT,CAAe,CAAf,EAAkBE,SAAS,CAAC1B,EAA5B,EAAgCH,MAAhC,CAAuC6B,SAAvC,CAAjB;AACA,YAAMG,QAAQ,GAAGF,QAAQ,CAACH,KAAT,CAAeE,SAAS,CAAC1B,EAAzB,EAA6B8B,GAA7B,CAAkC3B,GAAD,IAAS;AACzDA,QAAAA,GAAG,CAACH,EAAJ,GAASG,GAAG,CAACH,EAAJ,GAAS,CAAlB;AACA,eAAOG,GAAP;AACD,OAHgB,CAAjB;AAIA,aAAO,EACL,GAAGb,KADE;AAELP,QAAAA,MAAM,EAAEO,KAAK,CAACP,MAAN,GAAgB,CAFnB;AAGLD,QAAAA,IAAI,EAAE8C,QAAQ,CAAC/B,MAAT,CAAgBgC,QAAhB,CAHD;AAIL7C,QAAAA,OAAO,EAAEY;AAJJ,OAAP;;AAMF,SAAK,SAAL;AACE,YAAMmC,WAAW,GAAGtC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,KAAK,CAACR,IAArB,CAAX,CAApB;AACA,UAAIqB,GAAG,GAAG4B,WAAW,CAACd,IAAZ,CAAkBd,GAAD,IAASA,GAAG,CAACH,EAAJ,KAAWT,MAAM,CAAC2B,KAA5C,CAAV;AACAa,MAAAA,WAAW,CAACA,WAAW,CAACZ,OAAZ,CAAoBhB,GAApB,CAAD,CAAX,GAAwCZ,MAAM,CAACQ,IAA/C;AACA,aAAO,EACL,GAAGT,KADE;AAELR,QAAAA,IAAI,EAAEiD,WAFD;AAGLhD,QAAAA,MAAM,EAAEO,KAAK,CAACP,MAHT;AAILC,QAAAA,OAAO,EAAEY;AAJJ,OAAP;;AAMF,SAAK,UAAL;AACE,UAAI,CAACN,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BqB,MAAhC,EAAwC;AACtC,eAAO,EACL,GAAGhB;AADE,SAAP;AAGD;;AACD,YAAM0C,YAAY,GAAG1C,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BgD,EAA3B,CAA8B,CAAC,CAA/B,CAArB;AACA,aAAO,EACL,GAAG3C,KADE;AAELN,QAAAA,OAAO,EAAE;AACPC,UAAAA,WAAW,EAAEK,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BuC,KAA3B,CAAiC,CAAjC,EAAoC,CAAC,CAArC,CADN;AAEPtC,UAAAA,WAAW,EAAEI,KAAK,CAACN,OAAN,CAAeE,WAAf,CAA2BW,MAA3B,CAAkCmC,YAAlC;AAFN,SAFJ;AAMLlD,QAAAA,IAAI,EAAEkD;AAND,OAAP;;AAQF,SAAK,UAAL;AACE,UAAI,CAAC1C,KAAK,CAACN,OAAN,CAAeE,WAAf,CAA2BoB,MAAhC,EAAwC;AACtC,eAAO,EACL,GAAGhB;AADE,SAAP;AAGD;;AACD,YAAM4C,aAAa,GAAG5C,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BgD,EAA3B,CAA8B,CAAC,CAA/B,CAAtB;AACA,aAAO,EACL,GAAG3C,KADE;AAELN,QAAAA,OAAO,EAAE;AACPC,UAAAA,WAAW,EAAEK,KAAK,CAACN,OAAN,CAAeC,WAAf,CAA2BY,MAA3B,CAAkCqC,aAAlC,CADN;AAEPhD,UAAAA,WAAW,EAAEI,KAAK,CAACN,OAAN,CAAeE,WAAf,CAA2BsC,KAA3B,CAAiC,CAAjC,EAAoC,CAAC,CAArC;AAFN,SAFJ;AAML1C,QAAAA,IAAI,EAAEoD;AAND,OAAP;;AAQF;AACE,YAAM,IAAIC,KAAJ,CAAU,oBAAoB5C,MAAM,CAACO,IAArC,CAAN;AAjJJ;AAmJD,CAzJD;;AA2JA,MAAMsC,mBAAmB,GAAIC,KAAD,IAAgB;AAAA;;AAC1C,QAAM,CAAC/C,KAAD,EAAQgD,QAAR,IAAoB1D,UAAU,CAACS,OAAD,EAAUR,YAAV,CAApC;AACA,sBACE,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEC,MAAAA,IAAI,EAAEQ,KAAR;AAAeiD,MAAAA,YAAY,EAAED;AAA7B,KAA7B;AAAA,cACGD,KAAK,CAACG;AADT;AAAA;AAAA;AAAA;AAAA,UADF;AAKD,CAPD;;GAAMJ,mB;;KAAAA,mB;AASN,eAAeA,mBAAf","sourcesContent":["import React, { useReducer } from \"react\";\r\n\r\nexport interface Pixel {\r\n  xpos: number;\r\n  ypos: number;\r\n  color: string;\r\n}\r\n\r\nexport interface Art {\r\n  rows: Pixel[][];\r\n  id: number;\r\n}\r\n\r\ntype HistoryItem = Art[];\r\n\r\ntype History = HistoryItem[];\r\n\r\ninterface HistoryState {\r\n  prevHistory: History;\r\n  nextHistory: History;\r\n}\r\n\r\ninterface ArtsReducerState {\r\n  arts: Art[];\r\n  chosen: number | null;\r\n  history: HistoryState;\r\n}\r\n\r\ninterface ArtsReducerAction {\r\n  type: string;\r\n  data?: any;\r\n  artId?: number;\r\n  x?: number;\r\n  y?: number;\r\n}\r\n\r\ninterface ArtsProviderValue {\r\n  arts: ArtsReducerState;\r\n  artsDispatch: React.Dispatch<ArtsReducerAction>;\r\n}\r\n\r\nconst initialState: ArtsReducerState = {\r\n  arts: [],\r\n  chosen: null,\r\n  history: {\r\n    prevHistory: [],\r\n    nextHistory: [],\r\n  },\r\n};\r\n\r\nexport const ArtsContext = React.createContext<ArtsProviderValue | null>(null);\r\n\r\ninterface ArtsReducer {\r\n  (a: ArtsReducerState, b: ArtsReducerAction): ArtsReducerState;\r\n}\r\n\r\nconst reducer: ArtsReducer = (state, action) => {\r\n  const curSnapshot = JSON.parse(JSON.stringify(state.arts));\r\n  const newHistory = {\r\n    prevHistory: state.history!.prevHistory.concat(curSnapshot),\r\n    nextHistory: [],\r\n  };\r\n  switch (action.type) {\r\n    case \"ADD_ART\":\r\n      return {\r\n        ...state,\r\n        arts: [...state.arts!, action.data],\r\n        chosen: action.data.id,\r\n        history: newHistory,\r\n      };\r\n    case \"ADD_ROW\":\r\n      const newArts = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      newArts.forEach((art) => {\r\n        art.rows.push(action.data);\r\n      });\r\n      return {\r\n        ...state,\r\n        arts: newArts,\r\n        history: newHistory,\r\n      };\r\n    case \"DEL_ROW\":\r\n      const arts = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      if (arts[0].rows.length === 1) return { ...state, arts: state.arts };\r\n      arts.forEach((art) => {\r\n        art.rows.pop();\r\n      });\r\n      return {\r\n        ...state,\r\n        arts: arts,\r\n        history: newHistory,\r\n      };\r\n    case \"ADD_COL\":\r\n      const arts1 = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      arts1.forEach((art) => {\r\n        art.rows.forEach((row, id) => {\r\n          row.push({ xpos: action.data.x, ypos: id, color: action.data.color });\r\n        });\r\n      });\r\n      return {\r\n        ...state,\r\n        arts: arts1,\r\n        history: newHistory,\r\n      };\r\n    case \"DEL_COL\":\r\n      const arts2 = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      if (arts2[0].rows[0].length === 1) return { ...state, arts: state.arts };\r\n      arts2.forEach((art) => {\r\n        art.rows.forEach((row) => {\r\n          row.pop();\r\n        });\r\n      });\r\n      return {\r\n        ...state,\r\n        arts: arts2,\r\n        history: newHistory,\r\n      };\r\n    case \"SET_CHOSEN\":\r\n      return {\r\n        ...state,\r\n        chosen: action.data,\r\n        history: newHistory,\r\n      };\r\n    case \"SET_PIX\":\r\n      let arts3 = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      const a = arts3.find((art) => art.id === action.artId)!;\r\n      arts3[arts3.indexOf(a)].rows[action.y!][action.x!].color = action.data;\r\n      return {\r\n        ...state,\r\n        arts: arts3,\r\n        history: newHistory,\r\n      };\r\n    case \"DELETE_ART\":\r\n      if (state.arts.length === 1)\r\n        return {\r\n          ...state,\r\n        };\r\n      const deletedArt = state.arts.find((art) => art.id === action.data)!;\r\n      const arts4 = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      const startArts = arts4.slice(0, deletedArt.id);\r\n      const endArts = arts4.slice(deletedArt.id + 1);\r\n      endArts.forEach((art) => {\r\n        art.id = art.id - 1;\r\n      });\r\n      return {\r\n        ...state,\r\n        chosen: state.arts.length - 2,\r\n        arts: startArts.concat(endArts),\r\n        history: newHistory,\r\n      };\r\n    case \"COPY_ART\":\r\n      const copiedArt = JSON.parse(\r\n        JSON.stringify(state.arts.find((art) => art.id === action.data))\r\n      );\r\n      const newArts1 = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      copiedArt.id = copiedArt.id + 1;\r\n      const updArts1 = newArts1.slice(0, copiedArt.id).concat(copiedArt);\r\n      const updArts2 = newArts1.slice(copiedArt.id).map((art) => {\r\n        art.id = art.id + 1;\r\n        return art;\r\n      });\r\n      return {\r\n        ...state,\r\n        chosen: state.chosen! + 1,\r\n        arts: updArts1.concat(updArts2),\r\n        history: newHistory,\r\n      };\r\n    case \"UPD_ART\":\r\n      const updatedArts = JSON.parse(JSON.stringify(state.arts)) as Art[];\r\n      let art = updatedArts.find((art) => art.id === action.artId)!;\r\n      updatedArts[updatedArts.indexOf(art)] = action.data;\r\n      return {\r\n        ...state,\r\n        arts: updatedArts,\r\n        chosen: state.chosen,\r\n        history: newHistory,\r\n      };\r\n    case \"BACK_HIS\":\r\n      if (!state.history!.prevHistory.length) {\r\n        return {\r\n          ...state,\r\n        };\r\n      }\r\n      const lastSnapshot = state.history!.prevHistory.at(-1)!;\r\n      return {\r\n        ...state,\r\n        history: {\r\n          prevHistory: state.history!.prevHistory.slice(0, -1),\r\n          nextHistory: state.history!.nextHistory.concat(lastSnapshot),\r\n        },\r\n        arts: lastSnapshot,\r\n      };\r\n    case \"NEXT_HIS\":\r\n      if (!state.history!.nextHistory.length) {\r\n        return {\r\n          ...state,\r\n        };\r\n      }\r\n      const lastSnapshot1 = state.history!.prevHistory.at(-1)!;\r\n      return {\r\n        ...state,\r\n        history: {\r\n          prevHistory: state.history!.prevHistory.concat(lastSnapshot1),\r\n          nextHistory: state.history!.nextHistory.slice(0, -1),\r\n        },\r\n        arts: lastSnapshot1,\r\n      };\r\n    default:\r\n      throw new Error(\"Uncaught type: \" + action.type);\r\n  }\r\n};\r\n\r\nconst ArtsContextProvider = (props: any) => {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n  return (\r\n    <ArtsContext.Provider value={{ arts: state, artsDispatch: dispatch }}>\r\n      {props.children}\r\n    </ArtsContext.Provider>\r\n  );\r\n};\r\n\r\nexport default ArtsContextProvider;\r\n"]},"metadata":{},"sourceType":"module"}