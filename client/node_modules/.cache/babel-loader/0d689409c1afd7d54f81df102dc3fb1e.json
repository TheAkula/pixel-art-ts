{"ast":null,"code":"import _objectSpread from\"C:/Users/Pechenka/pixel-app-ts/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Pechenka/pixel-app-ts/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classes from\"./Board.module.css\";import createArt from\"../../hoc/createArt\";import{ArtsContext}from\"../../context/arts-context\";import{useContext,useEffect,useRef,useState}from\"react\";import Pixel from\"./Pixel/Pixel\";import{jsx as _jsx}from\"react/jsx-runtime\";var Board=function Board(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDraw=_useState2[0],setIsDraw=_useState2[1];var _ref=useContext(ArtsContext),artsState=_ref.artsState,artsDispatch=_ref.artsDispatch;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),draggedPixels=_useState4[0],setDraggedPixels=_useState4[1];var boardRef=useRef(null);useEffect(function(){if(artsState.chosen===null){var rows=createArt(artsState.settings);artsDispatch({type:\"ADD_ART\",data:{rows:rows,id:artsState.arts.length}});}},[artsDispatch,artsState.settings,artsState]);useEffect(function(){document.addEventListener(\"mouseup\",onMouseUp);document.addEventListener(\"dragstart\",function(e){return e.preventDefault();});},[]);var onMouseDown=function onMouseDown(){setIsDraw(true);};var onMouseUp=function onMouseUp(){setIsDraw(false);setDraggedPixels(function(prevDraggedPixels){return null;});};var pixelClickedHandler=function pixelClickedHandler(xpos,ypos,color){return function(e){e.preventDefault();switch(artsState.settings.tool){case\"BRUSH\":if(color===artsState.settings.color)return;artsDispatch({type:\"SET_PIX\",artId:artsState.chosen,data:artsState.settings.color,x:xpos,y:ypos});break;case\"ERASER\":if(color===artsState.settings.defColor)return;artsDispatch({type:\"SET_PIX\",artId:artsState.chosen,data:artsState.settings.defColor,x:xpos,y:ypos});break;case\"FILL\":var _art=JSON.parse(JSON.stringify(artsState.arts.find(function(art){return art.id===artsState.chosen;})));var fillPix=function fillPix(x,y){var checkPix=function checkPix(xp,yp){if(yp>_art.rows.length-1||yp<0||xp>_art.rows[yp].length||xp<0)return false;var pix=_art.rows[yp][xp];if(!pix)return false;var colorP=pix.color;return colorP!==artsState.settings.color&&colorP===color;};_art.rows[y][x].color=artsState.settings.color;if(checkPix(x+1,y)){fillPix(x+1,y);}if(checkPix(x,y+1)){fillPix(x,y+1);}if(checkPix(x,y-1)){fillPix(x,y-1);}if(checkPix(x-1,y)){fillPix(x-1,y);}};fillPix(xpos,ypos);artsDispatch({type:\"UPD_ART\",artId:artsState.chosen,data:_art});break;case\"PIPETTE\":artsDispatch({type:\"SET_COLOR\",data:color});break;case\"MOVE\":var dragPix=draggedPixels;if(!dragPix){setDraggedPixels({x:xpos,y:ypos});dragPix={x:xpos,y:ypos};}var x=xpos-dragPix.x;var y=ypos-dragPix.y;if(x>0){x=Math.floor(x/2);}else{x=Math.ceil(x/2);}if(y>0){y=Math.floor(y/2);}else{y=Math.ceil(y/2);}if(Math.abs(x)===1){setDraggedPixels({x:xpos,y:draggedPixels.y});}if(Math.abs(y)===1){setDraggedPixels({x:draggedPixels.x,y:ypos});}var newArt=JSON.parse(JSON.stringify(artsState.arts.find(function(art){return art.id===artsState.chosen;})));newArt.rows.forEach(function(row,ind){row.forEach(function(pix){var newX=pix.xpos+x;var newY=pix.ypos+y;pix.xpos=newX>row.length-1?newX-row.length:newX<0?row.length+newX:newX;pix.ypos=newY>newArt.rows.length-1?newY-newArt.rows.length:newY<0?newArt.rows.length+newY:newY;});if(x>0){newArt.rows[ind]=row.slice(row.length-x).concat(row.slice(0,row.length-x));}else{newArt.rows[ind]=row.slice(Math.abs(x)).concat(row.slice(0,Math.abs(x)));}});if(y>0){newArt.rows=newArt.rows.slice(newArt.rows.length-y).concat(newArt.rows.slice(0,newArt.rows.length-y));}else{newArt.rows=newArt.rows.slice(Math.abs(y)).concat(newArt.rows.slice(0,Math.abs(y)));}artsDispatch({type:\"UPD_ART\",data:newArt,artId:artsState.chosen});break;default:return;}};};var art=null;if(artsState.arts.length){art=artsState.arts.find(function(art){return art.id===artsState.chosen;});}var ps=500/artsState.settings.columnSize;return/*#__PURE__*/_jsx(\"div\",{ref:boardRef,className:classes.Board,children:art&&art.rows.map(function(arr){return arr.map(function(pixel){return/*#__PURE__*/_jsx(Pixel,_objectSpread({isDrawing:isDraw,size:ps,clicked:pixelClickedHandler,dragStarted:onMouseDown},pixel),pixel.ypos.toString()+pixel.xpos);});})});};export default Board;","map":{"version":3,"sources":["C:/Users/Pechenka/pixel-app-ts/client/src/components/Board/Board.tsx"],"names":["classes","createArt","ArtsContext","useContext","useEffect","useRef","useState","Pixel","Board","isDraw","setIsDraw","artsState","artsDispatch","draggedPixels","setDraggedPixels","boardRef","chosen","rows","settings","type","data","id","arts","length","document","addEventListener","onMouseUp","e","preventDefault","onMouseDown","prevDraggedPixels","pixelClickedHandler","xpos","ypos","color","tool","artId","x","y","defColor","art","JSON","parse","stringify","find","fillPix","checkPix","xp","yp","pix","colorP","dragPix","Math","floor","ceil","abs","newArt","forEach","row","ind","newX","newY","slice","concat","ps","columnSize","map","arr","pixel","toString"],"mappings":"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","sourcesContent":["import classes from \"./Board.module.css\";\r\nimport createArt from \"../../hoc/createArt\";\r\nimport { ArtsContext } from \"../../context/arts-context\";\r\nimport {\r\n  MouseEventHandler,\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { Art } from \"../../context/arts-context\";\r\n\r\nimport Pixel from \"./Pixel/Pixel\";\r\n\r\nconst Board = () => {\r\n  const [isDraw, setIsDraw] = useState(false);\r\n  const { artsState, artsDispatch } = useContext(ArtsContext)!;\r\n  const [draggedPixels, setDraggedPixels] = useState<null | {\r\n    x: number;\r\n    y: number;\r\n  }>(null);\r\n  const boardRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (artsState.chosen === null) {\r\n      const rows = createArt(artsState.settings!);\r\n      artsDispatch({\r\n        type: \"ADD_ART\",\r\n        data: {\r\n          rows: rows,\r\n          id: artsState.arts.length,\r\n        },\r\n      });\r\n    }\r\n  }, [artsDispatch, artsState.settings, artsState]);\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"mouseup\", onMouseUp);\r\n    document.addEventListener(\"dragstart\", (e) => e.preventDefault());\r\n  }, []);\r\n\r\n  const onMouseDown = () => {\r\n    setIsDraw(true);\r\n  };\r\n\r\n  const onMouseUp = () => {\r\n    setIsDraw(false);\r\n    setDraggedPixels((prevDraggedPixels) => null);\r\n  };\r\n\r\n  const pixelClickedHandler = (xpos: number, ypos: number, color: string) => {\r\n    return ((e) => {\r\n      e.preventDefault();\r\n\r\n      switch (artsState.settings!.tool) {\r\n        case \"BRUSH\":\r\n          if (color === artsState.settings!.color) return;\r\n          artsDispatch({\r\n            type: \"SET_PIX\",\r\n            artId: artsState.chosen!,\r\n            data: artsState.settings!.color,\r\n            x: xpos,\r\n            y: ypos,\r\n          });\r\n          break;\r\n        case \"ERASER\":\r\n          if (color === artsState.settings!.defColor) return;\r\n          artsDispatch({\r\n            type: \"SET_PIX\",\r\n            artId: artsState.chosen!,\r\n            data: artsState.settings!.defColor,\r\n            x: xpos,\r\n            y: ypos,\r\n          });\r\n          break;\r\n        case \"FILL\":\r\n          const art: Art = JSON.parse(\r\n            JSON.stringify(\r\n              artsState.arts.find((art) => art.id === artsState.chosen)\r\n            )\r\n          );\r\n          const fillPix = (x: number, y: number) => {\r\n            const checkPix = (xp: number, yp: number): boolean => {\r\n              if (\r\n                yp > art.rows.length - 1 ||\r\n                yp < 0 ||\r\n                xp > art.rows[yp].length ||\r\n                xp < 0\r\n              )\r\n                return false;\r\n              const pix = art.rows[yp][xp];\r\n              if (!pix) return false;\r\n              const colorP = pix.color;\r\n              return colorP !== artsState.settings!.color && colorP === color;\r\n            };\r\n            art.rows[y][x].color = artsState.settings!.color;\r\n\r\n            if (checkPix(x + 1, y)) {\r\n              fillPix(x + 1, y);\r\n            }\r\n            if (checkPix(x, y + 1)) {\r\n              fillPix(x, y + 1);\r\n            }\r\n            if (checkPix(x, y - 1)) {\r\n              fillPix(x, y - 1);\r\n            }\r\n            if (checkPix(x - 1, y)) {\r\n              fillPix(x - 1, y);\r\n            }\r\n          };\r\n          fillPix(xpos, ypos);\r\n          artsDispatch({\r\n            type: \"UPD_ART\",\r\n            artId: artsState.chosen!,\r\n            data: art,\r\n          });\r\n          break;\r\n        case \"PIPETTE\":\r\n          artsDispatch!({ type: \"SET_COLOR\", data: color });\r\n          break;\r\n        case \"MOVE\":\r\n          let dragPix = draggedPixels;\r\n          if (!dragPix) {\r\n            setDraggedPixels({ x: xpos, y: ypos });\r\n            dragPix = { x: xpos, y: ypos };\r\n          }\r\n          let x = xpos - dragPix!.x;\r\n          let y = ypos - dragPix!.y;\r\n          if (x > 0) {\r\n            x = Math.floor(x / 2);\r\n          } else {\r\n            x = Math.ceil(x / 2);\r\n          }\r\n          if (y > 0) {\r\n            y = Math.floor(y / 2);\r\n          } else {\r\n            y = Math.ceil(y / 2);\r\n          }\r\n\r\n          if (Math.abs(x) === 1) {\r\n            setDraggedPixels({ x: xpos, y: draggedPixels!.y });\r\n          }\r\n          if (Math.abs(y) === 1) {\r\n            setDraggedPixels({ x: draggedPixels!.x, y: ypos });\r\n          }\r\n          const newArt = JSON.parse(\r\n            JSON.stringify(\r\n              artsState.arts.find((art) => art.id === artsState.chosen)\r\n            )\r\n          ) as Art;\r\n          newArt.rows.forEach((row, ind) => {\r\n            row.forEach((pix) => {\r\n              const newX = pix.xpos + x;\r\n              const newY = pix.ypos + y;\r\n              pix.xpos =\r\n                newX > row.length - 1\r\n                  ? newX - row.length\r\n                  : newX < 0\r\n                  ? row.length + newX\r\n                  : newX;\r\n              pix.ypos =\r\n                newY > newArt.rows.length - 1\r\n                  ? newY - newArt.rows.length\r\n                  : newY < 0\r\n                  ? newArt.rows.length + newY\r\n                  : newY;\r\n            });\r\n            if (x > 0) {\r\n              newArt.rows[ind] = row\r\n                .slice(row.length - x)\r\n                .concat(row.slice(0, row.length - x));\r\n            } else {\r\n              newArt.rows[ind] = row\r\n                .slice(Math.abs(x))\r\n                .concat(row.slice(0, Math.abs(x)));\r\n            }\r\n          });\r\n          if (y > 0) {\r\n            newArt.rows = newArt.rows\r\n              .slice(newArt.rows.length - y)\r\n              .concat(newArt.rows.slice(0, newArt.rows.length - y));\r\n          } else {\r\n            newArt.rows = newArt.rows\r\n              .slice(Math.abs(y))\r\n              .concat(newArt.rows.slice(0, Math.abs(y)));\r\n          }\r\n          artsDispatch({\r\n            type: \"UPD_ART\",\r\n            data: newArt,\r\n            artId: artsState.chosen!,\r\n          });\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n    }) as MouseEventHandler<HTMLDivElement>;\r\n  };\r\n\r\n  let art: null | Art = null;\r\n\r\n  if (artsState.arts.length) {\r\n    art = artsState.arts!.find((art) => art.id === artsState.chosen)!;\r\n  }\r\n\r\n  const ps = 500 / artsState.settings!.columnSize;\r\n  return (\r\n    <div ref={boardRef} className={classes.Board}>\r\n      {art &&\r\n        art.rows.map((arr) => {\r\n          return arr.map((pixel) => (\r\n            <Pixel\r\n              isDrawing={isDraw}\r\n              size={ps}\r\n              clicked={pixelClickedHandler}\r\n              dragStarted={onMouseDown}\r\n              key={pixel.ypos.toString() + pixel.xpos}\r\n              {...pixel}\r\n            />\r\n          ));\r\n        })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Board;\r\n"]},"metadata":{},"sourceType":"module"}