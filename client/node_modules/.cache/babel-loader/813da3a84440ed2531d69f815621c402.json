{"ast":null,"code":"import _slicedToArray from\"C:/Users/Pechenka/pixel-app-ts/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useContext,useEffect,useState,useRef}from\"react\";import classes from\"./PreviewAnimation.module.css\";import SimplePixel from\"../../SimplePixel/SimplePixel\";import{ArtsContext}from\"../../../context/arts-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PreviewAnimation=function PreviewAnimation(props){var _useState=useState(1),_useState2=_slicedToArray(_useState,2),duration=_useState2[0],setDuration=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),play=_useState4[0],setPlay=_useState4[1];var _ref=useContext(ArtsContext),arts=_ref.arts;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),artToShow=_useState6[0],setArtToShow=_useState6[1];var timer=useRef(null);var updateArtToShow=useCallback(function(){setArtToShow(function(prevArt){var index=prevArt.id+1;if(index===arts.arts.length){index=0;}var art=arts.arts.find(function(art){return art.id===index;});return art;});},[arts.arts]);useEffect(function(){if(!play){var art=arts.arts.find(function(art){return art.id===arts.chosen;});setArtToShow(art);}},[arts,play]);useEffect(function(){if(play){if(timer.current===null){timer.current=setInterval(updateArtToShow,duration*1000);}}else if(timer.current!==null){clearInterval(timer.current);timer.current=null;}},[play,duration,updateArtToShow,artToShow]);var onTogglePlayHandler=function onTogglePlayHandler(){setPlay(!play);};var ps=6;return/*#__PURE__*/_jsxs(\"div\",{className:classes.PreviewAnimation,children:[/*#__PURE__*/_jsx(\"button\",{className:classes.PlayButton,onClick:onTogglePlayHandler,children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"}),/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:classes.PreviewAnimationSpace,children:/*#__PURE__*/_jsx(\"div\",{children:artToShow&&artToShow.rows.map(function(row){return/*#__PURE__*/_jsx(\"div\",{className:classes.Row,children:row.map(function(pix){return/*#__PURE__*/_jsx(SimplePixel,{ps:ps,pix:pix},pix.ypos.toString()+pix.xpos);})},artToShow.rows.indexOf(row));})})})]});};export default PreviewAnimation;","map":{"version":3,"sources":["C:/Users/Pechenka/pixel-app-ts/src/components/SettingsBar/PreviewAnimation/PreviewAnimation.tsx"],"names":["useCallback","useContext","useEffect","useState","useRef","classes","SimplePixel","ArtsContext","PreviewAnimation","props","duration","setDuration","play","setPlay","arts","artToShow","setArtToShow","timer","updateArtToShow","prevArt","index","id","length","art","find","chosen","current","setInterval","clearInterval","onTogglePlayHandler","ps","PlayButton","PreviewAnimationSpace","rows","map","row","Row","pix","ypos","toString","xpos","indexOf"],"mappings":"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","sourcesContent":["import { useCallback, useContext, useEffect, useState, useRef } from \"react\";\r\n\r\nimport classes from \"./PreviewAnimation.module.css\";\r\nimport SimplePixel from \"../../SimplePixel/SimplePixel\";\r\n\r\nimport { Art, ArtsContext } from \"../../../context/arts-context\";\r\n\r\ninterface PreviewAnimationProps {\r\n  duration: number;\r\n}\r\n\r\nconst PreviewAnimation = (props: PreviewAnimationProps) => {\r\n  const [duration, setDuration] = useState(1);\r\n  const [play, setPlay] = useState(false);\r\n  const { arts } = useContext(ArtsContext)!;\r\n  const [artToShow, setArtToShow] = useState<null | Art>(null);\r\n  let timer = useRef<null | NodeJS.Timer>(null);\r\n\r\n  const updateArtToShow = useCallback(() => {\r\n    setArtToShow((prevArt) => {\r\n      let index = prevArt!.id + 1;\r\n      if (index === arts.arts.length) {\r\n        index = 0;\r\n      }\r\n      const art = arts.arts.find((art) => art.id === index)!;\r\n      return art;\r\n    });\r\n  }, [arts.arts]);\r\n\r\n  useEffect(() => {\r\n    if (!play) {\r\n      const art = arts.arts.find((art) => art.id === arts.chosen)!;\r\n      setArtToShow(art);\r\n    }\r\n  }, [arts, play]);\r\n\r\n  useEffect(() => {\r\n    if (play) {\r\n      if (timer.current === null) {\r\n        timer.current = setInterval(updateArtToShow, duration * 1000);\r\n      }\r\n    } else if (timer.current !== null) {\r\n      clearInterval(timer.current);\r\n      timer.current = null;\r\n    }\r\n  }, [play, duration, updateArtToShow, artToShow]);\r\n\r\n  const onTogglePlayHandler = () => {\r\n    setPlay(!play);\r\n  };\r\n\r\n  const ps = 6;\r\n\r\n  return (\r\n    <div className={classes.PreviewAnimation}>\r\n      <button className={classes.PlayButton} onClick={onTogglePlayHandler}>\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          className=\"h-6 w-6\"\r\n          fill=\"none\"\r\n          viewBox=\"0 0 24 24\"\r\n          stroke=\"currentColor\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth=\"2\"\r\n            d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"\r\n          />\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth=\"2\"\r\n            d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      </button>\r\n      <div className={classes.PreviewAnimationSpace}>\r\n        <div>\r\n          {artToShow &&\r\n            artToShow.rows.map((row) => (\r\n              <div className={classes.Row} key={artToShow.rows.indexOf(row)}>\r\n                {row.map((pix) => (\r\n                  <SimplePixel\r\n                    key={pix.ypos.toString() + pix.xpos}\r\n                    ps={ps}\r\n                    pix={pix}\r\n                  />\r\n                ))}\r\n              </div>\r\n            ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PreviewAnimation;\r\n"]},"metadata":{},"sourceType":"module"}