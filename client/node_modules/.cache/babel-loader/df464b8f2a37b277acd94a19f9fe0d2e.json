{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pechenka\\\\pixel-app-ts\\\\client\\\\src\\\\context\\\\arts-context.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useReducer } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  artsState: {\n    arts: [],\n    chosen: null,\n    settings: {\n      pixelSize: 10,\n      defColor: \"rgb(49, 49, 49)\",\n      rowSize: 16,\n      columnSize: 16,\n      color: \"rgb(49, 49, 49)\",\n      tool: null\n    }\n  },\n  history: {\n    prevHistory: [],\n    nextHistory: []\n  }\n};\nexport const ArtsContext = /*#__PURE__*/React.createContext(null);\n\nconst reducer = (state, action) => {\n  const curSnapshot = { ...JSON.parse(JSON.stringify(state.artsState))\n  };\n  const newHistory = {\n    prevHistory: state.history.prevHistory.concat([curSnapshot]),\n    nextHistory: []\n  };\n\n  switch (action.type) {\n    case \"ADD_ART\":\n      const addedArt = action.data;\n      const arts5 = JSON.parse(JSON.stringify(state.artsState.arts));\n      const difY = action.data.rows.length - state.artsState.settings.rowSize;\n      const difX = action.data.rows[0].length - state.artsState.settings.columnSize;\n      const cs = difX <= 0 ? state.artsState.settings.columnSize : state.artsState.settings.columnSize + difX;\n      const rs = difY <= 0 ? state.artsState.settings.rowSize : state.artsState.settings.rowSize + difY;\n\n      if (difY > 0) {\n        arts5.forEach(art => {\n          for (let i = 0; i < difY; i++) {\n            const row = [];\n\n            for (let j = 0; j < state.artsState.settings.columnSize; j++) {\n              row.push({\n                xpos: j,\n                ypos: state.artsState.settings.rowSize + i,\n                color: state.artsState.settings.defColor\n              });\n            }\n\n            art.rows.push(row);\n          }\n        });\n      } else if (difY < 0) {\n        for (let i = 0; i < Math.abs(difY); i++) {\n          const row = [];\n\n          for (let j = 0; j < addedArt.rows[0].length; j++) {\n            row.push({\n              xpos: j,\n              ypos: addedArt.rows.length + i,\n              color: state.artsState.settings.defColor\n            });\n          }\n\n          addedArt.rows.push(row);\n        }\n      }\n\n      if (difX > 0) {\n        arts5.forEach(art => {\n          for (let i = 0; i < difX; i++) {\n            for (let j = 0; j < rs; j++) {\n              art.rows[j].push({\n                xpos: state.artsState.settings.columnSize + i,\n                ypos: j,\n                color: state.artsState.settings.defColor\n              });\n            }\n          }\n        });\n      } else if (difX < 0) {\n        for (let i = 0; i < Math.abs(difX); i++) {\n          for (let j = 0; j < rs; j++) {\n            addedArt.rows[j].push({\n              xpos: addedArt.rows[0].length + i,\n              ypos: j,\n              color: state.artsState.settings.defColor\n            });\n          }\n        }\n      }\n\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: arts5.concat(action.data),\n          chosen: action.data.id,\n          settings: { ...state.artsState.settings,\n            columnSize: state.artsState.settings.columnSize + (difX > 0 ? difX : 0),\n            rowSize: state.artsState.settings.rowSize + (difY > 0 ? difY : 0)\n          }\n        },\n        history: newHistory\n      };\n\n    case \"ADD_ROW\":\n      const newArts = JSON.parse(JSON.stringify(state.artsState.arts));\n      newArts.forEach(art => {\n        art.rows.push(action.data);\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: newArts,\n          settings: { ...state.artsState.settings,\n            rowSize: state.artsState.settings.rowSize + 1\n          }\n        },\n        history: newHistory\n      };\n\n    case \"DEL_ROW\":\n      const arts = JSON.parse(JSON.stringify(state.artsState.arts));\n      if (arts[0].rows.length === 1) return { ...state,\n        arts: state.artsState.arts\n      };\n      arts.forEach(art => {\n        art.rows.pop();\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: arts,\n          settings: { ...state.artsState.settings,\n            rowSize: state.artsState.settings.rowSize - 1 || 1\n          }\n        },\n        history: newHistory\n      };\n\n    case \"ADD_COL\":\n      const arts1 = JSON.parse(JSON.stringify(state.artsState.arts));\n      arts1.forEach(art => {\n        art.rows.forEach((row, id) => {\n          row.push({\n            xpos: action.data.x,\n            ypos: id,\n            color: action.data.color\n          });\n        });\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: arts1,\n          settings: { ...state.artsState.settings,\n            columnSize: state.artsState.settings.columnSize + 1\n          }\n        },\n        history: newHistory\n      };\n\n    case \"DEL_COL\":\n      const arts2 = JSON.parse(JSON.stringify(state.artsState.arts));\n      if (arts2[0].rows[0].length === 1) return { ...state\n      };\n      arts2.forEach(art => {\n        art.rows.forEach(row => {\n          row.pop();\n        });\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: arts2,\n          settings: { ...state.artsState.settings,\n            columnSize: state.artsState.settings.columnSize - 1\n          }\n        },\n        history: newHistory\n      };\n\n    case \"SET_TOOL\":\n      return { ...state,\n        artsState: { ...state.artsState,\n          settings: { ...state.artsState.settings,\n            tool: action.data\n          }\n        }\n      };\n\n    case \"SET_COLOR\":\n      return { ...state,\n        artsState: { ...state.artsState,\n          settings: { ...state.artsState.settings,\n            color: action.data\n          }\n        }\n      };\n\n    case \"SET_CHOSEN\":\n      return { ...state,\n        artsState: { ...state.artsState,\n          chosen: action.data\n        },\n        history: newHistory\n      };\n\n    case \"SET_PIX\":\n      let arts3 = JSON.parse(JSON.stringify(state.artsState.arts));\n      const a = arts3.find(art => art.id === action.artId);\n      arts3[arts3.indexOf(a)].rows[action.y][action.x].color = action.data;\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: arts3\n        },\n        history: newHistory\n      };\n\n    case \"DELETE_ART\":\n      if (state.artsState.arts.length === 1) return { ...state\n      };\n      const deletedArt = state.artsState.arts.find(art => art.id === action.data);\n      const arts4 = JSON.parse(JSON.stringify(state.artsState.arts));\n      const startArts = arts4.slice(0, deletedArt.id);\n      const endArts = arts4.slice(deletedArt.id + 1);\n      endArts.forEach(art => {\n        art.id = art.id - 1;\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          chosen: state.artsState.arts.length - 2,\n          arts: startArts.concat(endArts)\n        },\n        history: newHistory\n      };\n\n    case \"COPY_ART\":\n      const copiedArt = JSON.parse(JSON.stringify(state.artsState.arts.find(art => art.id === action.data)));\n      const newArts1 = JSON.parse(JSON.stringify(state.artsState.arts));\n      copiedArt.id = copiedArt.id + 1;\n      const updArts1 = newArts1.slice(0, copiedArt.id).concat(copiedArt);\n      const updArts2 = newArts1.slice(copiedArt.id).map(art => {\n        art.id = art.id + 1;\n        return art;\n      });\n      return { ...state,\n        artsState: { ...state.artsState,\n          chosen: state.artsState.chosen + 1,\n          arts: updArts1.concat(updArts2)\n        },\n        history: newHistory\n      };\n\n    case \"UPD_ART\":\n      const updatedArts = JSON.parse(JSON.stringify(state.artsState.arts));\n      let art = updatedArts.find(art => art.id === action.artId);\n      updatedArts[updatedArts.indexOf(art)] = action.data;\n      return { ...state,\n        artsState: { ...state.artsState,\n          arts: updatedArts,\n          chosen: state.artsState.chosen\n        },\n        history: newHistory\n      };\n\n    case \"BACK_HIS\":\n      if (!state.history.prevHistory.length) {\n        return { ...state\n        };\n      }\n\n      const lastSnapshot = state.history.prevHistory.at(-1);\n      if (!lastSnapshot.arts.length) return { ...state\n      };\n      return {\n        history: {\n          prevHistory: state.history.prevHistory.slice(0, -1),\n          nextHistory: state.history.nextHistory.concat([JSON.parse(JSON.stringify(state.artsState))])\n        },\n        artsState: { ...lastSnapshot\n        }\n      };\n\n    case \"NEXT_HIS\":\n      if (!state.history.nextHistory.length) {\n        return { ...state\n        };\n      }\n\n      const lastSnapshot1 = state.history.nextHistory.at(-1);\n      if (!lastSnapshot1.arts) return { ...state\n      };\n      return {\n        history: {\n          prevHistory: state.history.prevHistory.concat([JSON.parse(JSON.stringify(state.artsState))]),\n          nextHistory: state.history.nextHistory.slice(0, -1)\n        },\n        artsState: { ...lastSnapshot1\n        }\n      };\n\n    case \"SET_PS\":\n      return { ...state,\n        artsState: { ...state.artsState,\n          settings: { ...state.artsState.settings,\n            pixelSize: action.data\n          }\n        }\n      };\n\n    default:\n      throw new Error(\"Uncaught type: \" + action.type);\n  }\n};\n\nconst ArtsContextProvider = props => {\n  _s();\n\n  const [state, dispatch] = useReducer(reducer, initialState);\n  return /*#__PURE__*/_jsxDEV(ArtsContext.Provider, {\n    value: {\n      artsState: state.artsState,\n      artsDispatch: dispatch\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 408,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ArtsContextProvider, \"6JWkGZ32UPfojeNx+xqn8ZU8A0Q=\");\n\n_c = ArtsContextProvider;\nexport default ArtsContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ArtsContextProvider\");","map":{"version":3,"sources":["C:/Users/Pechenka/pixel-app-ts/client/src/context/arts-context.tsx"],"names":["React","useReducer","initialState","artsState","arts","chosen","settings","pixelSize","defColor","rowSize","columnSize","color","tool","history","prevHistory","nextHistory","ArtsContext","createContext","reducer","state","action","curSnapshot","JSON","parse","stringify","newHistory","concat","type","addedArt","data","arts5","difY","rows","length","difX","cs","rs","forEach","art","i","row","j","push","xpos","ypos","Math","abs","id","newArts","pop","arts1","x","arts2","arts3","a","find","artId","indexOf","y","deletedArt","arts4","startArts","slice","endArts","copiedArt","newArts1","updArts1","updArts2","map","updatedArts","lastSnapshot","at","lastSnapshot1","Error","ArtsContextProvider","props","dispatch","artsDispatch","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\r\n\r\nexport interface Pixel {\r\n  xpos: number;\r\n  ypos: number;\r\n  color: string;\r\n}\r\n\r\nexport interface Art {\r\n  rows: Pixel[][];\r\n  id: number;\r\n}\r\n\r\ntype HistoryItem = ArtsState;\r\n\r\ntype History = HistoryItem[];\r\n\r\ninterface HistoryState {\r\n  prevHistory: History;\r\n  nextHistory: History;\r\n}\r\n\r\ninterface SettingsState {\r\n  defColor: string;\r\n  rowSize: number;\r\n  columnSize: number;\r\n  color: string;\r\n  tool: \"BRUSH\" | \"FILL\" | \"ERASER\" | \"PIPETTE\" | \"MOVE\" | null;\r\n  pixelSize: number;\r\n}\r\n\r\ninterface ArtsState {\r\n  arts: Art[];\r\n  chosen: number | null;\r\n  settings: SettingsState;\r\n}\r\n\r\ninterface ArtsReducerState {\r\n  artsState: ArtsState;\r\n  history: HistoryState;\r\n}\r\n\r\ninterface ArtsReducerAction {\r\n  type: string;\r\n  data?: any;\r\n  artId?: number;\r\n  x?: number;\r\n  y?: number;\r\n}\r\n\r\ninterface ArtsProviderValue {\r\n  artsState: ArtsState;\r\n  artsDispatch: React.Dispatch<ArtsReducerAction>;\r\n}\r\n\r\nconst initialState: ArtsReducerState = {\r\n  artsState: {\r\n    arts: [],\r\n    chosen: null,\r\n    settings: {\r\n      pixelSize: 10,\r\n      defColor: \"rgb(49, 49, 49)\",\r\n      rowSize: 16,\r\n      columnSize: 16,\r\n      color: \"rgb(49, 49, 49)\",\r\n      tool: null,\r\n    },\r\n  },\r\n\r\n  history: {\r\n    prevHistory: [],\r\n    nextHistory: [],\r\n  },\r\n};\r\n\r\nexport const ArtsContext = React.createContext<ArtsProviderValue | null>(null);\r\n\r\ninterface ArtsReducer {\r\n  (a: ArtsReducerState, b: ArtsReducerAction): ArtsReducerState;\r\n}\r\n\r\nconst reducer: ArtsReducer = (state, action) => {\r\n  const curSnapshot = { ...JSON.parse(JSON.stringify(state.artsState)) };\r\n  const newHistory = {\r\n    prevHistory: state.history.prevHistory.concat([curSnapshot]),\r\n    nextHistory: [],\r\n  };\r\n  switch (action.type) {\r\n    case \"ADD_ART\":\r\n      const addedArt = action.data;\r\n      const arts5 = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      const difY = action.data.rows.length - state.artsState.settings.rowSize;\r\n      const difX =\r\n        action.data.rows[0].length - state.artsState.settings.columnSize;\r\n      const cs =\r\n        difX <= 0\r\n          ? state.artsState.settings.columnSize\r\n          : state.artsState.settings.columnSize + difX;\r\n      const rs =\r\n        difY <= 0\r\n          ? state.artsState.settings.rowSize\r\n          : state.artsState.settings.rowSize + difY;\r\n      if (difY > 0) {\r\n        arts5.forEach((art) => {\r\n          for (let i = 0; i < difY; i++) {\r\n            const row = [];\r\n            for (let j = 0; j < state.artsState.settings.columnSize; j++) {\r\n              row.push({\r\n                xpos: j,\r\n                ypos: state.artsState.settings.rowSize + i,\r\n                color: state.artsState.settings.defColor,\r\n              });\r\n            }\r\n            art.rows.push(row);\r\n          }\r\n        });\r\n      } else if (difY < 0) {\r\n        for (let i = 0; i < Math.abs(difY); i++) {\r\n          const row = [];\r\n          for (let j = 0; j < addedArt.rows[0].length; j++) {\r\n            row.push({\r\n              xpos: j,\r\n              ypos: addedArt.rows.length + i,\r\n              color: state.artsState.settings.defColor,\r\n            });\r\n          }\r\n          addedArt.rows.push(row);\r\n        }\r\n      }\r\n      if (difX > 0) {\r\n        arts5.forEach((art) => {\r\n          for (let i = 0; i < difX; i++) {\r\n            for (let j = 0; j < rs; j++) {\r\n              art.rows[j].push({\r\n                xpos: state.artsState.settings.columnSize + i,\r\n                ypos: j,\r\n                color: state.artsState.settings.defColor,\r\n              });\r\n            }\r\n          }\r\n        });\r\n      } else if (difX < 0) {\r\n        for (let i = 0; i < Math.abs(difX); i++) {\r\n          for (let j = 0; j < rs; j++) {\r\n            addedArt.rows[j].push({\r\n              xpos: addedArt.rows[0].length + i,\r\n              ypos: j,\r\n              color: state.artsState.settings.defColor,\r\n            });\r\n          }\r\n        }\r\n      }\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: arts5.concat(action.data),\r\n          chosen: action.data.id,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            columnSize:\r\n              state.artsState.settings.columnSize + (difX > 0 ? difX : 0),\r\n            rowSize: state.artsState.settings.rowSize + (difY > 0 ? difY : 0),\r\n          },\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"ADD_ROW\":\r\n      const newArts = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      newArts.forEach((art) => {\r\n        art.rows.push(action.data);\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: newArts,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            rowSize: state.artsState.settings.rowSize + 1,\r\n          },\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"DEL_ROW\":\r\n      const arts = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      if (arts[0].rows.length === 1)\r\n        return { ...state, arts: state.artsState.arts };\r\n      arts.forEach((art) => {\r\n        art.rows.pop();\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: arts,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            rowSize: state.artsState.settings.rowSize - 1 || 1,\r\n          },\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"ADD_COL\":\r\n      const arts1 = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      arts1.forEach((art) => {\r\n        art.rows.forEach((row, id) => {\r\n          row.push({ xpos: action.data.x, ypos: id, color: action.data.color });\r\n        });\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: arts1,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            columnSize: state.artsState.settings.columnSize + 1,\r\n          },\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"DEL_COL\":\r\n      const arts2 = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      if (arts2[0].rows[0].length === 1)\r\n        return {\r\n          ...state,\r\n        };\r\n      arts2.forEach((art) => {\r\n        art.rows.forEach((row) => {\r\n          row.pop();\r\n        });\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: arts2,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            columnSize: state.artsState.settings.columnSize - 1,\r\n          },\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"SET_TOOL\":\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            tool: action.data,\r\n          },\r\n        },\r\n      };\r\n    case \"SET_COLOR\":\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            color: action.data,\r\n          },\r\n        },\r\n      };\r\n    case \"SET_CHOSEN\":\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          chosen: action.data,\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"SET_PIX\":\r\n      let arts3 = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      const a = arts3.find((art) => art.id === action.artId)!;\r\n      arts3[arts3.indexOf(a)].rows[action.y!][action.x!].color = action.data;\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: arts3,\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"DELETE_ART\":\r\n      if (state.artsState.arts.length === 1)\r\n        return {\r\n          ...state,\r\n        };\r\n      const deletedArt = state.artsState.arts.find(\r\n        (art) => art.id === action.data\r\n      )!;\r\n      const arts4 = JSON.parse(JSON.stringify(state.artsState.arts)) as Art[];\r\n      const startArts = arts4.slice(0, deletedArt.id);\r\n      const endArts = arts4.slice(deletedArt.id + 1);\r\n      endArts.forEach((art) => {\r\n        art.id = art.id - 1;\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          chosen: state.artsState.arts.length - 2,\r\n          arts: startArts.concat(endArts),\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"COPY_ART\":\r\n      const copiedArt = JSON.parse(\r\n        JSON.stringify(\r\n          state.artsState.arts.find((art) => art.id === action.data)\r\n        )\r\n      );\r\n      const newArts1 = JSON.parse(\r\n        JSON.stringify(state.artsState.arts)\r\n      ) as Art[];\r\n      copiedArt.id = copiedArt.id + 1;\r\n      const updArts1 = newArts1.slice(0, copiedArt.id).concat(copiedArt);\r\n      const updArts2 = newArts1.slice(copiedArt.id).map((art) => {\r\n        art.id = art.id + 1;\r\n        return art;\r\n      });\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          chosen: state.artsState.chosen! + 1,\r\n          arts: updArts1.concat(updArts2),\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"UPD_ART\":\r\n      const updatedArts = JSON.parse(\r\n        JSON.stringify(state.artsState.arts)\r\n      ) as Art[];\r\n      let art = updatedArts.find((art) => art.id === action.artId)!;\r\n      updatedArts[updatedArts.indexOf(art)] = action.data;\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          arts: updatedArts,\r\n          chosen: state.artsState.chosen,\r\n        },\r\n        history: newHistory,\r\n      };\r\n    case \"BACK_HIS\":\r\n      if (!state.history.prevHistory.length) {\r\n        return {\r\n          ...state,\r\n        };\r\n      }\r\n      const lastSnapshot = state.history.prevHistory.at(-1)!;\r\n      if (!lastSnapshot.arts.length) return { ...state };\r\n      return {\r\n        history: {\r\n          prevHistory: state.history.prevHistory.slice(0, -1),\r\n          nextHistory: state.history.nextHistory.concat([\r\n            JSON.parse(JSON.stringify(state.artsState)),\r\n          ]),\r\n        },\r\n        artsState: {\r\n          ...lastSnapshot,\r\n        },\r\n      };\r\n    case \"NEXT_HIS\":\r\n      if (!state.history.nextHistory.length) {\r\n        return {\r\n          ...state,\r\n        };\r\n      }\r\n      const lastSnapshot1 = state.history.nextHistory.at(-1)!;\r\n      if (!lastSnapshot1.arts) return { ...state };\r\n      return {\r\n        history: {\r\n          prevHistory: state.history.prevHistory.concat([\r\n            JSON.parse(JSON.stringify(state.artsState)),\r\n          ]),\r\n          nextHistory: state.history.nextHistory.slice(0, -1),\r\n        },\r\n        artsState: {\r\n          ...lastSnapshot1,\r\n        },\r\n      };\r\n    case \"SET_PS\":\r\n      return {\r\n        ...state,\r\n        artsState: {\r\n          ...state.artsState,\r\n          settings: {\r\n            ...state.artsState.settings,\r\n            pixelSize: action.data,\r\n          },\r\n        },\r\n      };\r\n    default:\r\n      throw new Error(\"Uncaught type: \" + action.type);\r\n  }\r\n};\r\n\r\nconst ArtsContextProvider = (props: any) => {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n  return (\r\n    <ArtsContext.Provider\r\n      value={{ artsState: state.artsState, artsDispatch: dispatch }}\r\n    >\r\n      {props.children}\r\n    </ArtsContext.Provider>\r\n  );\r\n};\r\n\r\nexport default ArtsContextProvider;\r\n"]},"metadata":{},"sourceType":"module"}